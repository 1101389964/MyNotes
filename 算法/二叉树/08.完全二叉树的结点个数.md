## [完全二叉树的节点个数](https://leetcode.cn/problems/count-complete-tree-nodes/)

* **题目：**

  >给你一棵 **完全二叉树** 的根节点 `root` ，求出该树的节点个数。
  >
  >[完全二叉树](https://baike.baidu.com/item/完全二叉树/7773232?fr=aladdin) 的定义如下：在完全二叉树中，除了最底层节点可能没填满外，其余每层节点数都达到最大值，并且最下面一层的节点都集中在该层最左边的若干位置。若最底层为第 `h` 层，则该层包含 `1~ 2h` 个节点。

* **示例：**

  * **示例1：**<br>![img](08.完全二叉树的结点个数.assets/complete.jpg)

    ```
    输入：root = [1,2,3,4,5,6]
    输出：6
    ```

  * **示例2：**

    ```
    输入：root = []
    输出：0
    ```

  * **示例3：**

    ```
    输入：root = []
    输出：0
    ```

  * **提示：**

    * 树中节点的数目范围是`[0, 5 * 104]`
    * `0 <= Node.val <= 5 * 104`
    * 题目数据保证输入的树是 **完全二叉树**

* **解析：**

  >**[题解](https://www.programmercarl.com/0222.%E5%AE%8C%E5%85%A8%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E8%8A%82%E7%82%B9%E4%B8%AA%E6%95%B0.html#%E5%AE%8C%E5%85%A8%E4%BA%8C%E5%8F%89%E6%A0%91)**
  >
  >完全二叉树只有两种情况，**情况一**：就是满二叉树，**情况二**：最后一层叶子节点没有满。
  >
  >**对于情况一**，可以直接用 2^树深度 - 1 来计算，注意这里根节点深度为1。
  >
  >**对于情况二**，分别递归左孩子，和右孩子，递归到某一深度一定会有左孩子或者右孩子为满二叉树，然后依然可以按照情况1来计算。<br><img src="08.完全二叉树的结点个数.assets/20201124092543662.png" alt="222.完全二叉树的节点个数" style="zoom: 50%;" />

* **代码：**

  ```js
  // 试用于所有的二叉树
  var countNodes = function(root) {
      if (!root) return 0; 
      return 1 + countNodes(root.left) + countNodes(root.right); 
  };
  
  // 针对完全二叉树
  var countNodes = function(root) {
      if (!root) return 0;
      let rootLeft = root, rootRight = root;
      let leftLen = 0, rightLen = 0;
      // 求左子树深度
      while (rootLeft) {
          rootLeft = rootLeft.left;
          leftLen++;
      }
      // 求右子树深度
      while (rootRight) {
          rootRight = rootRight.right;
          rightLen++;
      }
      // 当左右子树高度相等就可以使用公式。
      if (leftLen === rightLen) {
          return Math.pow(2, leftLen) - 1;
      }
      return 1 + countNodes(root.left) + countNodes(root.right);
  }
  
  ```