**声明：call，apply，bind的实现本质都是用c++实现的，这里js只是模仿其功能**

## 用js实现bind

### 步骤：

1. 如何在任意一个函数上调用call方法？
   **在Function的原型上定义自己的call方法，每个函数都可以访问到**

   ```js
   Function.prototype.myCall = function(argthis, ...agrs) { }
   ```

2. **如何在定义的call方法上获取到被绑定的函数？**
   **使用`this`，由于foo.myCall使用了隐式绑定所以在myCall上可以的this指向就是foo**

   ```js
   Function.prototype.myCall = function(argthis, ...agrs) {
     const fun = this;
     // 如果原函数有返回结果需要返回
     return fun(...agrs)
   }
   ```

3. **如何实现this绑定？**

   **使用隐式绑定，将fun添加到argsthis上**

   ```js
   Function.prototype.myCall = function(argthis, ...agrs) {
     argthis.fun = this;
     // 如果原函数有返回结果需要返回  
     return argthis.fun(...agrs);
     // 不能改变原对象
     delete argthis.fun
   }
   ```

4. 当绑定为非对象需要改变this指向，需要将其转换为对象模式，比如number => Number，string => String；

   任何类型使用`new Object()`都会转为相对应的类型

   ```js
   Function.prototype.myCall = function(argthis, ...agrs) {
     // 当传递的为一个对象，new Object() 会原封不动返回，所以不会有影响
     argthis = new Object(argthis);
     argthis.fun = this;
     // 如果原函数有返回结果需要返回  
     return argthis.fun(...agrs);
     // 不能改变原对象
     delete argthis.fun
   }
   ```

5. 当传递的为`undefined`或者`null`，call指向的是window，这里需要额外处理下，使用三元运算符实现

   ```js
   Function.prototype.myCall = function(argthis, ...agrs) {
     // 当传递的为一个对象，new Object() 会原封不动返回，所以不会有影响
     argthis = (argthis === undefined || argthis === null) ? window : new Object(argthis);
     argthis.fun = this;
     // 如果原函数有返回结果需要返回  
     return argthis.fun(...agrs);
     // 不能改变原对象
     delete argthis.fun
   }
   ```



## 实现apply

```js
// 传递的参数有区别，如果没有传递参数需要特殊处理，否则undefined用剩余参数会报错
Function.prototype.myApply = function(argthis, agrs = []) {
  argthis = (argthis === undefined || argthis === null) ? window : new Object(argthis);
  argthis.fun = this;
  return argthis.fun(...agrs);
  delete argthis.fun
}
```



## 实现bind

```js
const foo = fun.bind(this, agrs1, args2);
foo(args3, agrs4); // 上面的agrs1,args2，与args3，args4会拼在一起传递给 fun

Function.prototype.myBind = function(argthis, ...agrs) {
  const fn = this;
  argthis = (argthis === undefined || argthis === null) ? window : new Object(argthis);
  // bind 是返回一个函数，执行该函数改变this指向改变
  return function(...arg) {
    // 拼接参数
    const agrss = [...arg, ...agrs];
    argthis.fn = fn;
    const res = argthis.fn(...agrss);
    delete argthis.fn;
    return res;
  }
}
```



